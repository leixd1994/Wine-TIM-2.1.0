String.prototype.format=function(){var a=arguments;return this.replace(/\{(\d+)\}/g,function(b,c){return a[c]})};String.prototype.setCharAt=function(b,a){if(b>this.length-1){return str}return this.substr(0,b)+a+this.substr(b+1)};function getOuterLink(d,a){var b="{0}loginid.aspx?uid={1}&p={2}";var c=getOuterBaseLink(d)+a;window.open(c)}function getOuterLinkLogin(c,a,e){var b="{0}loginid.aspx?uid={1}&p={2}";var d=b.format(getOuterBaseLink("NAVI"),encodeURIComponent(e),encodeURIComponent(a));window.open(d,"knstarget")}function getOuterBaseLink(b){var a="";b=b.toUpperCase();switch(b){case"NAVI":if(typeof(BaseLink_NAVI)!="undefined"){a=BaseLink_NAVI?BaseLink_NAVI:""}break;case"COVER":if(typeof(BaseLink_COVER)!="undefined"){a=BaseLink_COVER?BaseLink_COVER:""}break;case"LIB":if(typeof(BaseLink_LIB)!="undefined"){a=BaseLink_LIB}break;case"AD":if(typeof(BaseLink_AD)!="undefined"){a=BaseLink_AD?BaseLink_AD:""}break;case"TOKNS":if(typeof(BaseLink_TOKNS)!="undefined"){a=BaseLink_TOKNS?BaseLink_TOKNS:""}break;case"REFBOOK":if(typeof(BaseLink_REFBOOK)!="undefined"){a=BaseLink_REFBOOK?BaseLink_REFBOOK:""}break;case"CRRS":if(typeof(BaseLink_CRRS)!="undefined"){a=BaseLink_CRRS?BaseLink_CRRS:""}break;case"TOKMYCNKI":if(typeof(BaseLink_TOKMYCNKI)!="undefined"){a=BaseLink_TOKMYCNKI?BaseLink_TOKMYCNKI:""}break;case"KNSVOTE":if(typeof(BaseLink_knsvote)!="undefined"){a=BaseLink_knsvote?BaseLink_knsvote:""}break;case"KLOGINFOOTER":if(typeof(BaseLink_KloginFooter)!="undefined"){a=BaseLink_KloginFooter?BaseLink_KloginFooter:""}break;case"KLOGIN":if(typeof(BaseLink_Klogin)!="undefined"){a=BaseLink_Klogin?BaseLink_Klogin:""}break;case"KREDIS":if(typeof(BaseLink_Kredis)!="undefined"){a=BaseLink_Kredis?BaseLink_Kredis:""}break;case"CRLDENG":if(typeof(BaseLink_CRLDENG)!="undefined"){a=BaseLink_CRLDENG?BaseLink_CRLDENG:""}break;case"LIBINFO":if(typeof(BaseLink_LibInfo)!="undefined"){a=BaseLink_LibInfo?BaseLink_LibInfo:""}break;case"RECOMMEND":if(typeof(BaseLink_Recommend)!="undefined"){a=BaseLink_Recommend?BaseLink_Recommend:""}break;case"TOKNET":if(typeof(BaseLink_TOKNET)!="undefined"){a=BaseLink_TOKNET?BaseLink_TOKNET:""}break;case"TOKREADER":if(typeof(BaseLink_TOKREADER)!="undefined"){a=BaseLink_TOKREADER?BaseLink_TOKREADER:""}break;case"BQSM":if(typeof(BaseLink_BQSM)!="undefined"){a=BaseLink_BQSM?BaseLink_BQSM:""}break;case"SUBTURNURL":if(typeof(BaseLink_SubTurnURL)!="undefined"){a=BaseLink_SubTurnURL?BaseLink_SubTurnURL:""}break;case"EXPORTKCMSURL":if(typeof(BaseLink_ExportKcmsURL)!="undefined"){a=BaseLink_ExportKcmsURL?BaseLink_ExportKcmsURL:""}break}return a}function getKns55NaviLink(g,e,a,c){var h="{0}loginid.aspx?uid={1}&p={2}";var f="navi/Bridge.aspx?LinkType=BaseLink&DBCode={0}&TableName={1}&Field=BaseID&Value={2}";e=e.toLowerCase();if(e=="cjsf"){a="cjfdbaseinfo"}var b=f.format(e,a,c);var d=h.format(getOuterBaseLink("NAVI"),encodeURIComponent(g),encodeURIComponent(b));window.open(d,"knstarget")}function getKns55NaviLinkIssue(i,f,a,c,j,k){var h="{0}loginid.aspx?uid={1}&p={2}";var g="navi/Bridge.aspx?LinkType=IssueLink&DBCode={0}&TableName={1}&ShowField=cname&Field=BaseID*year*issue&Value={2}*{3}*{4}";var e="Navi/Bridge.aspx?LinkType=IssueLink&DBCode={0}&TableName={1}&ShowField=cname&Field=thname&Value={2}{3}{4}";f=f.toLowerCase();if(f=="cjsf"){a="cjfdyearinfo"}if(f=="cfjd"||f=="cfjw"||f=="cfjg"||f=="cfjc"||f=="cfjx"){a="cfedyearinfo"}if(f=="ccjd"||f=="cjfv"||f=="cjfu"||f=="cjfz"||f=="cjfy"||f=="cjfx"||f=="cjft"||f=="cjfr"){a="";g=e}var b=g.format(f,a,c,j,k);var d=h.format(getOuterBaseLink("NAVI"),encodeURIComponent(i),encodeURIComponent(b));window.open(d,"knstarget")}function getKns55UnitNaviLink(g,d,e){var c="{0}loginid.aspx?uid={1}&p={2}";var b="navi/Bridge.aspx?DBCode={0}&UnitCode={1}";d=d.toLowerCase();if(d=="cmbf"||d=="cmbf2011"||d=="cmsf"||d=="cmzd"||d=="cfmd"){d="cmfd"}else{if(d=="cdbf"||d=="cdbf2011"||d=="cdsf"||d=="cdmd"){d="cdfd"}}var a=b.format(d,e);var f=c.format(getOuterBaseLink("NAVI"),encodeURIComponent(g),encodeURIComponent(a));window.open(f,"knstarget")}function getKns55YearNaviLink(g,e,a,c,h){var i="{0}loginid.aspx?uid={1}&p={2}";var f="navi/Bridge.aspx?LinkType=YearLink&DBCode={0}&TableName={1}&ShowField={4}&Field={5}*year&Value={2}*{3}";var b=f.format(e,a,c,h,encodeURIComponent("年鉴中文名"),"BaseID");var d=i.format(getOuterBaseLink("NAVI"),encodeURIComponent(g),encodeURIComponent(b));window.open(d,"knstarget")}function getKns55CYFDNaviLink(g,e,a,c){var h="{0}loginid.aspx?uid={1}&p={2}";var f="navi/Bridge.aspx?LinkType=BaseLink&DBCode={0}&TableName={1}&Field={3}&Value={2}";e=e.toLowerCase();var b=f.format(e,a,c,encodeURIComponent("种编码"));var d=h.format(getOuterBaseLink("NAVI"),encodeURIComponent(g),encodeURIComponent(b));window.open(d,"knstarget")}function OpenCRLDENG(a){if(typeof(BaseLink_CRLDENG)=="undefined"||BaseLink_CRLDENG==null||BaseLink_CRLDENG==""){return""}window.open(BaseLink_CRLDENG+encodeURIComponent(a),"kcmsnavitarget")}function GetRefBookLink(a){if(typeof(BaseLink_REFBOOK)=="undefined"||BaseLink_REFBOOK==null||BaseLink_REFBOOK==""){return""}var b="{0}BasicSearch.aspx?kw={1}";return b.format(BaseLink_REFBOOK,a)}function login(){var a=window.location.href;var b="../login.aspx?url="+encodeURIComponent(a);window.location=b}function logout(){var a=window.location.href;var b="../logout.aspx?url="+encodeURIComponent(a);window.location=b}function MM_swapImage(b,a){b.src=a}function OnDownloadMore(c,b,f,d,e){var a=c+"?ti="+encodeURIComponent(b)+"&tb="+f+"&fn="+d+"&code="+e;window.open(a,"download","height=200, width=400, top=100,left=300, toolbar=no, menubar=no, scrollbars=no, resizable=no,location=no, status=no")}function OpenDLMore(d,b,c){var a="../../download.aspx?filename="+d+"&tablename="+b+"&pubstr="+c;window.open(a,"_blank")}function ChangeReferType(a){var b=document.getElementById("rl"+a);var c=document.getElementsByName(b.name);for(var d=0;d<c.length;d++){c[d].className=""}b.className="ReferLinkOn"}function ShowChar(f){var a=document.getElementById(f).innerHTML;var b="";for(var e=0;e<a.length;e++){var d=a.charCodeAt(e);b+=d+":"+a[e]+";"}alert(b)}function RemoveUnknownChar(a){for(var d=0;d<a.length;d++){var b=a.charCodeAt(d);if(b==57361||b==57355||b==57347||b==57348){a=a.setCharAt(d," ")}if(b==58426){a=a.setCharAt(d,"ö")}}return a}function KeywordFilter(a){a=a.replace(/:[\d]+/g,"");return a}var g_Summary=new Object();var g_SummaryLength=500;function AbstractFilter(d,a,e){var c=document.getElementById(d);var b=c.innerHTML;g_Summary[d]=b;ResetSummary(d,a,e)}function MoerSummary(d,a,e){var c=document.getElementById(d);var b=g_Summary[d];b=RemoveUnknownChar(b);c.innerHTML=b+"&nbsp;";document.getElementById(a).style.display="none";document.getElementById(e).style.display=""}function ResetSummary(d,a,e){var c=document.getElementById(d);var b=g_Summary[d];if(b.length>g_SummaryLength){b=b.substring(0,g_SummaryLength)+"...";document.getElementById(a).style.display="";document.getElementById(e).style.display="none"}b=RemoveUnknownChar(b);c.innerHTML=b+"&nbsp;"}function GetCookie(a){var b="[;]*[s]*"+a+"=([^;]*)";var c=new RegExp(b);if(c.test(document.cookie)){return RegExp["$1"]}else{return""}}function GetLib(d){link=getOuterBaseLink("LIB");var c=document.getElementById("lib");if(link!=""&&c){var b="<a target='_blank' href='{0}' >{1}</a> | ";var a=GetCookie("LID");if(a){link=link+"&uid="+a}b=b.format(encodeURI(link),d);c.innerHTML=b}}function MetaFilter(f,c){var b=/\[A\]([^\[]+)\[\/A]/ig;var d=/\[BR\]/ig;var e='<a href="meta.aspx?key={0}&dbcode={2}" >{1}</a>';function a(g,h){return e.format(encodeURIComponent(h),h,c)}f=f.replace(b,a);f=f.replace(d,"</p><p>");document.write(f)}function OpenMeta(a,b){url="meta.aspx?key={0}&dbcode={1}";window.open(url.format(encodeURIComponent(a),b))}function Translate(a,b,c){google.language.translate(a,"zh-CN",b,function(d){if(d.translation){document.getElementById(c).innerHTML=d.translation}})}function getQueryString(b){var c=new RegExp("(^|&)"+b+"=([^&]*)(&|$)","i");var a=window.location.search.substr(1).match(c);if(a!=null){return unescape(a[2])}return null}function SubScriptionForD(){var d=$("#deliveryType").val();var c=$("#deliveryUid").val();var a=$("#deliveryCoutent").val();if(a.indexOf("#")>-1){var b=a.split("#");if(b[0]!=""&&b[0].toLocaleLowerCase()!="f0"){a=b[0]}else{a=b[1]}}content=encodeURIComponent(a);SubTurn(d,c,content,"")}function SubScription(e,c,b,a){if(e==""){e=$("#deliveryType").val()}var d=getQueryString("filename")+";";if(a){d=a+";"}SubTurn(e,c,b,d)}function SubTurn(j,c,b,f){var a="../detail/frame/SubTurnPage.aspx";var i=document.createElement("form");i.method="post";i.setAttribute("target","_blank");i.action=a;var g=document.createElement("input");g.setAttribute("name","SubT");g.setAttribute("value",j);i.appendChild(g);var h=document.createElement("input");h.setAttribute("name","SubC");h.setAttribute("value",b+f);i.appendChild(h);var d=document.createElement("input");d.setAttribute("name","SubU");d.setAttribute("value",c);i.appendChild(d);var e=document.createElement("input");e.setAttribute("name","cnkiUserKey");e.setAttribute("value",GetCookie("cnkiUserKey"));i.appendChild(e);document.body.appendChild(i);i.submit();document.body.removeChild(i)}function SubTurnExport(d,c){var a=document.createElement("form");a.method="post";a.setAttribute("target","_blank");a.action=d;var b=document.createElement("input");b.setAttribute("name","formfilenames");b.setAttribute("value",c);a.appendChild(b);document.body.appendChild(a);a.submit();document.body.removeChild(a)}function AttentionService(b){var d=$("#deliveryType").val();var a=$("#deliveryUid").val();var e=$("#deliveryTable").val();var c=$("#deliveryCoutent").val();c=encodeURIComponent(c);AttentionServiceParam(d,a,e,c,b)}function SetNewGuid(){var b="";for(var c=1;c<=32;c++){var a=Math.floor(Math.random()*16).toString(16);b+=a;if((c==8)||(c==12)||(c==16)||(c==20)){b+="-"}}return b}function SetCookie(a,d,b){if(GetCookie(a)==""||GetCookie(a)==null){var c=new Date();c.setDate(c.getDate()+b);document.cookie=a+"="+escape(d)+((b==null)?"":";expires="+c.toGMTString())+"; path=/;domain=cnki.net"}}function AttentionServiceParam(d,a,f,c,b){var e=GetCookie("cnkiUserKey");if(!e){e=SetNewGuid();SetCookie("cnkiUserKey",SetNewGuid(),3650)}$(document).ready(function(){var h=getOuterBaseLink("SUBTURNURL")+"/KnsDelivery/ExtendDB/addattention.ashx?un="+a+"&skey="+e+"&type="+d+"&dbName="+f+"&content="+c;if(b=="1"){h=h+"&p=1"}try{RequestJsonObject(h,function(){if(typeof result!="undefined"){var i=result.data[0].msg;var j=result.data[0].code;if(b=="1"){if(j=="2"){$("#AttentionYes").show();$("#AttentionNo").hide()}}else{$("#popupmsg").html(i+"!");$("#popupTips").show();setTimeout(function(){$("#popupTips").fadeOut();$("#popupmsg").html("");$("#AttentionYes").show();$("#AttentionNo").hide()},10000)}}})}catch(g){}$("#coreContent").hide()})}function Attention(){if($("#coreContent").css("display")=="none"){$(".attention div input[type=checkBox]").each(function(){$(this).removeAttr("checked")});$("#coreContent").css({top:$("#attAuthor").position().top+19});$("#coreContent").show();$("#coreContent").unbind("mouseleave").bind("mouseleave",function(){$(".attention div input[type=checkBox]").each(function(){$(this).removeAttr("checked")});$(this).hide()})}else{$("#coreContent").hide()}}function showNewAu(b,a){url="knetsearch.aspx?sfield=au&skey={0}&code={1}";window.open(url.format(encodeURIComponent(b),a),"_self")}function showFileAddInfo(a,h,g,i,b){closePopMore(1);$(".active").attr("class","");if(b){if($("#showmoreid").val()==g){$(".popMore").remove();return}else{$(".popMore").remove()}}else{if(parent.$("#showmoreid").val()==g){parent.$(".popMore").remove();return}else{parent.$(".popMore").remove()}}var e=parent.$("#deliveryUid").val();i=encodeURIComponent(i);var d="/KCMS/detail/detail.aspx?dbcode={0}&dbname={1}&filename={2}";d=d.format(a,h,g);var c="<div class='popMore'><input id='showmoreid' type='hidden' value='"+g+"'/><div class='pmShare'>分享到"+ShareAstrList(a,h,g,"sharebd")+"</div></div>";var f=a+g;if(f.indexOf(".")>0){f=f.substring(0,f.indexOf("."))}$("a[id^='"+f+"']").parent().attr("class","active");if(b){$("#func603").append(c);$(".popMore").css("left",$("a[id^='"+f+"']").offset().left-196);$(".popMore").css("top",$("a[id^='"+f+"']").offset().top-175)}else{if(window.parent.getIframeByElement(document.body)&&window.parent.getIframeByElement(document.body).id){$(parent.document.body).append(c);parent.$(".popMore").css("left",parent.$("#"+window.parent.getIframeByElement(document.body).id).offset().left+$("a[id^='"+f+"']").offset().left-84);parent.$(".popMore").css("top",parent.$("#"+window.parent.getIframeByElement(document.body).id).offset().top+$("a[id^='"+f+"']").offset().top-66)}}}function closePopMore(a){$(".popMore").remove();$("li").each(function(){$(this).removeClass("active")});$("iframe").each(function(){$(this).contents().find("li").each(function(){$(this).removeClass("active")});$(this).removeClass("active")});parent.$("iframe").each(function(){$(this).contents().find("li").each(function(){$(this).removeClass("active")});$(this).removeClass("active")})}function AddFav(f,a,c,b,e){var d="http://www.cnki.net/KCMS/detail/detail.aspx?dbcode={0}&dbname={1}&filename={2}&v={3}";d=d.format(f,a,c,b);AddFavorite(d,e)}function AddFavTitle(b){var a=document.URL;b=(b==""?document.title:b);AddFavorite(a,b)}function AddFavorite(c,a){try{window.external.addFavorite(c,decodeURIComponent(a))}catch(b){try{window.sidebar.addPanel(decodeURIComponent(a),c,"")}catch(b){alert("由于您的浏览器不支持，请使用Ctrl+D进行添加到收藏。")}}}function ShareAstr(a){var b="<ul class='"+a+"' id='sharedet'><li><a href='javascript:void(0);'  onclick=ShareAction('xl')     class='xl' title='分享到新浪微博'><i></i>新浪微博</a></li><li><a href='javascript:void(0);'  onclick=ShareAction('tx')     class='tx' title='分享到腾讯微博'><i></i>腾讯微博</a></li><li><a href='javascript:void(0);'  onclick=ShareAction('rr')     class='rr' title='分享到人人网'><i></i>人人网</a></li><li><a href='javascript:void(0);'  onclick=ShareAction('kx')     class='kx' title='分享到开心网'><i></i>开心网</a></li><li><a href='javascript:void(0);'  onclick=ShareAction('db')     class='db' title='分享到豆瓣网'><i></i>豆瓣网</a></li><li><a href='javascript:void(0);'  onclick=ShareAction('wy')     class='wy' title='分享到网易微博'><i></i>网易微博</a></li></ul>";return b}function ShareAstrWx(){var a="<ul class='shareVer' id='sharedet'><li><a href='javascript:void(0);'  onclick=ShareAction('xl')     class='icon-empty icon-tsina' title='分享到新浪微博'><i></i>新浪微博</a></li><li><a href='javascript:void(0);'  onclick=ShareAction('tx')     class='icon-empty icon-tencent' title='分享到腾讯微博'><i></i>腾讯微博</a></li><li><a href='javascript:void(0);'  onclick=ShareAction('rr')     class='icon-empty icon-renren' title='分享到人人网'><i></i>人人网</a></li><li><a href='javascript:void(0);'  onclick=ShareAction('kx')     class='icon-empty icon-kaixin' title='分享到开心网'><i></i>开心网</a></li><li><a href='javascript:void(0);'  onclick=ShareAction('db')     class='icon-empty icon-douban' title='分享到豆瓣网'><i></i>豆瓣网</a></li><li><a href='javascript:void(0);'  onclick=ShareAction('wy')     class='icon-empty icon-163t' title='分享到网易微博'><i></i>网易微博</a></li></ul>";return a}function ShareAU(b,a){var c="<ul class='"+b+"' id='sharedet'><li><a href='javascript:void(0);'  onclick=ShareActionAU('"+a+"','xl')     class='xl' title='分享到新浪微博'><i></i>新浪微博</a></li><li><a href='javascript:void(0);'  onclick=ShareActionAU('"+a+"','tx')     class='tx' title='分享到腾讯微博'><i></i>腾讯微博</a></li><li><a href='javascript:void(0);'  onclick=ShareActionAU('"+a+"','rr')     class='rr' title='分享到人人网'><i></i>人人网</a></li><li><a href='javascript:void(0);'  onclick=ShareActionAU('"+a+"','kx')     class='kx' title='分享到开心网'><i></i>开心网</a></li><li><a href='javascript:void(0);'  onclick=ShareActionAU('"+a+"','db')     class='db' title='分享到豆瓣网'><i></i>豆瓣网</a></li><li><a href='javascript:void(0);'  onclick=ShareActionAU('"+a+"','wy')     class='wy' title='分享到网易微博'><i></i>网易微博</a></li></ul>";document.write(c)}function ShareAstrList(e,d,b,a){var c="<span class='"+a+"' id='sharedet'><a href='javascript:void(0);'  onclick=ShareActionList('"+e+"','"+d+"','"+b+"','xl')     class='xl' title='分享到新浪微博'><i></i>新浪微博</a><a href='javascript:void(0);'  onclick=ShareActionList('"+e+"','"+d+"','"+b+"','tx')     class='tx' title='分享到腾讯微博'><i></i>腾讯微博</a><a href='javascript:void(0);'  onclick=ShareActionList('"+e+"','"+d+"','"+b+"','rr')     class='rr' title='分享到人人网'><i></i>人人网</a><a href='javascript:void(0);'  onclick=ShareActionList('"+e+"','"+d+"','"+b+"','kx')     class='kx' title='分享到开心网'><i></i>开心网</a><a href='javascript:void(0);'  onclick=ShareActionList('"+e+"','"+d+"','"+b+"','db')     class='db' title='分享到豆瓣网'><i></i>豆瓣网</a><a href='javascript:void(0);'  onclick=ShareActionList('"+e+"','"+d+"','"+b+"','wy')     class='wy' title='分享到网易微博'><i></i>网易微博</a></span>";return c}function ShareAction(t){var knshost=getOuterBaseLink("CRRS");var dbcode=getQueryString("dbcode");var dbname=getQueryString("dbname");var filename=getQueryString("filename");var sendurlDetail=knshost+"/CRRS/Services/Share.ashx?dbcode="+dbcode+"&dbname="+dbname+"&filename="+filename+"&target=kns&type="+t+"&cnkiUserKey="+GetCookie("cnkiUserKey");var sendurlDoi=knshost+"/CRRS/Services/Share.ashx?urlInfo="+encodeURIComponent(document.URL)+"&content="+encodeURIComponent(document.title)+"&type="+t+"&target=custom&cnkiUserKey="+GetCookie("cnkiUserKey");var sendurl=sendurlDetail;if(filename==""){sendurl=sendurlDoi}var curUrl="share.ashx?dbCode="+dbcode+"&filename="+filename;var referUrl=document.referrer;try{var userName="";if(window.parent.$("#klogin_isPersonal").val()=="1"){userName=window.parent.$("#klogin_userName").val()}else{if($("#klogin_isPersonal").val()=="1"){userName=$("#klogin_userName").val()}}if(typeof(eval(WriteActionLog))=="function"){WriteActionLog(userName,GetCookie("cnkiUserKey"),curUrl,referUrl)}}catch(e){}window.open(sendurl,"kcmstarget","width=480,height=430, menubar=no, scrollbars=no,resizable=yes,location=no, status=no")}function ShareActionList(f,e,b,d){var c=getOuterBaseLink("CRRS");var a=c+"/CRRS/Services/Share.ashx?dbcode="+f+"&dbname="+e+"&filename="+b+"&target=kns&type="+d+"&cnkiUserKey="+GetCookie("cnkiUserKey");window.open(a,"kcmstarget","width=480,height=430, menubar=no, scrollbars=no,resizable=yes,location=no, status=no")}function ShareActionAU(d,c){var b=getOuterBaseLink("CRRS");var a=b+"/CRRS/Services/Share.ashx?urlInfo="+encodeURIComponent(document.URL)+"&content="+encodeURIComponent(d)+"&type="+c+"&target=custom&cnkiUserKey="+GetCookie("cnkiUserKey");window.open(a,"kcmstarget","width=480,height=430, menubar=no, scrollbars=no,resizable=yes,location=no, status=no")}function getIframeByElement(b){var a;$("iframe").each(function(){if(b.ownerDocument===this.contentWindow.document){a=this}return !a});return a}function TurnPageToKnet(d,a,c){if(d==null||d==""){d="kw"}a=encodeURIComponent(a);var b="/kcms/detail/knetsearch.aspx?sfield={0}&skey={1}&code={2}";b=b.format(d,a,c);window.open(b,"kcmstarget"+d)}function TurnPageToKns(e,a,c){var d=getOuterBaseLink("TOKNS");var b="";if(a==""){a=parent.$("#showname").html()}a=encodeURIComponent(a);if(e==0){b=d+"/kns/RedirectPage.aspx?action=indexpage&code={1}&kw={0}";if(c.toLowerCase()!="crpd"){b+="&korder=1"}}else{if(e==1){b=d+"/kns/RedirectPage.aspx?action=navipage&code={1}&kw={0}";if(c.toLowerCase()=="ccnd"){b+="&korder=2"}else{b+="&korder=1"}}}b=b.format(a,c);window.open(b,"knstarget")}function TurnPageToKnsNavi(c,i,f){var b="";var e=getOuterBaseLink("TOKNS");var d="/kns/Navi/Bridge.aspx?NaviID=100&BaseID={0}&NaviLink={1}";var h="/kns/Navi/Bridge.aspx?NaviID=1004&CatalogName=cpfdnavi2&Field=navi178&Value={0}&HYJiDaiMa={0}&MeetingName={1}";var a="/kns/Navi/Bridge.aspx?NaviID=34&DBCode=cmfd&UnitCode={0}";var g="/kns/Navi/Bridge.aspx?NaviID=25&BaseID={0}&BaseName={1}&NaviLink={1}";c=c.toLowerCase();if(c.indexOf("cjfd")>-1){b=d.format(i,f)}else{if(c.indexOf("cmfd")>-1){b=a.format(i)}else{if(c.indexOf("cpfd")>-1){b=h.format(i,f)}else{if(c.indexOf("ccnd")>-1){b=g.format(i,f)}}}}window.open(e+b,"knstarget")}function SetWaitHide(){setTimeout(function(){$("#waitDiv").attr("style","visibility:hidden");$("#loadingDot").hide()},5000)}function toTop(){$(document).ready(function(){$(window).scroll(function(){if($(window).scrollTop()>=360){$("#backtop").removeClass("hiddenV")}else{$("#backtop").addClass("hiddenV")}if($(window).scrollTop()>=190){$("#CatalogSide").addClass("KnetSideFix");SetCatalogFloatBottom()}else{$("#CatalogSide").removeClass("KnetSideFix")}if($(window).scrollTop()>=350){$("#kcmscatalog").addClass("KnetSideFix");SetCatalogFloatBottom()}else{$("#kcmscatalog").removeClass("KnetSideFix")}})})}function SetCatalogFloatBottom(){var d=$("#kcmscatalog");if($("#kcmscatalog").length>0){d=$("#kcmscatalog")}else{d=$("#CatalogSide")}if(d.length<1){return}var a=$("#footerBox").offset().top;var e=$(document).height();var f=$(window).height();var c=d.height();var b=$(window).scrollTop()-(a-10-c);if(c+10>=f){d.removeClass("KnetSideFix")}else{if(b>0){d.attr("style","top:-"+b+"px;transition:top 1s;-moz-transition: top 1s;-webkit-transition: top 1s;")}else{d.attr("style","top:10px;transition:top 1s;-moz-transition: top 1s;-webkit-transition: top 1s;")}}}function InsertCatalog(){$("#sideCatalogCont").html($(".wxnav").html());$("#nulldata").height($("#sideCatalogCont").height()+82)}function setCatalog(){if($("#sideCatalogCont").html()==""){return}if($("#sideCatalogCont").hasClass("hiddenV")){$("#sideCatalogCont").removeClass("hiddenV");$("#nulldata").show()}else{$("#sideCatalogCont").addClass("hiddenV");$("#nulldata").hide()}}function SetCatalogNoData(a){parent.$("#"+a).addClass("fsI");parent.$("#waitDiv").attr("style","visibility:hidden");TurnToTitle(a);parent.$(".loadingDot").remove()}function SetParentCatalog(){$(".title1").each(function(){if($(this).attr("id")!=""){var a="l"+$(this).attr("id");showCatalogId(a)}});$(".title2").each(function(){if($(this).attr("id")!=""){var a="l"+$(this).attr("id");showCatalogId(a)}});$(".title3").each(function(){if($(this).attr("id")!=""){var a="l"+$(this).attr("id");showCatalogId(a)}});parent.$(".popMore").remove();parent.$("#waitDiv").attr("style","visibility:hidden")}function showCatalogId(a){if(parent.$("#"+a).length>0){parent.$("#"+a).show();parent.$("#kcmscatalog").show();parent.$(".loadingDot").remove()}}function setCurClass(a){$("dt[id^='lcatalog']").each(function(){$(this).removeClass("cur")});$("dd[id^='lcatalog']").each(function(){$(this).removeClass("cur")});$("#l"+a).addClass("cur");a=a.replace("frame","");$("#l"+a).addClass("cur");$("#lcatalog_"+a).addClass("cur")}var isScrollByTurnToTitle=false;function TurnToTitle(a){if(a==""){return}setCurClass(a);if($("#"+a).length>0){$("html,body").animate({scrollTop:$("#"+a).offset().top},500)}else{$("iframe").each(function(){try{if(this.contentWindow.document.getElementById(a)){$("html,body").animate({scrollTop:$(this).offset().top+this.contentWindow.GetElementOffset(a)},500)}}catch(b){if($("#"+a).length>1){$("html,body").animate({scrollTop:$(this).offset().top+$("#"+a).offset()},500)}}})}isScrollByTurnToTitle=true}function GetElementOffset(a){return $("#"+a).offset().top}function GetUserCenter(a){var b=unescape(getOuterBaseLink("KLOGIN")+a);var c=$(".mycnki");if(c.length==1&&b.trim()!=""){c.find(".mycnkipop").remove();c.unbind();$.getJSON(b,{url:"/kcms/login.aspx?url="+encodeURIComponent(window.location.href)},function(d){c.append(unescape(d.html))})}}function GetQueryStringByName(c,a){if("[object String]"==Object.prototype.toString.call(c)&&"[object String]"==Object.prototype.toString.call(a)){var b=c.match(new RegExp("[?&]"+a+"=([^&]+)","i"));if(b==null||b.length<1){return""}return b[1]}return""}function SetQueryStringByName(e,a,b){if("[object String]"==Object.prototype.toString.call(e)){var c=e.match(new RegExp("([?&]+)"+a+"=[^&]*","i"));var d=e;if(c!=null){d=e.replace(c[0],c[1]+a+"="+encodeURI(b))}else{if(e.indexOf("?")<0){d=e+"?"+a+"="+b}else{d=e+"&"+a+"="+b}}return d}return""}(function(a){var b=function(){};b.getHeader=function(f){var c=getOuterBaseLink("KLOGIN");var e=unescape(c);var d="1";var j=",CJFT,CJFU,CJFV,CJFX,CJFY";var k=GetQueryStringByName(location.href,"dbcode");var h=GetQueryStringByName(location.href,"sfield");if(j.indexOf(k)>0&&(h==null||h=="")){d="3"}var i=e+"&uid="+f+"&flag="+d;var l="";var g=a("#headerBox");if(g.length==1&&a.trim(e)!=""){a.getJSON(i,{url:l},function(m){g.html(unescape(m.html))})}};b.getFooter=function(){var c=getOuterBaseLink("KLOGINFOOTER");var d=unescape(c);var e=a("#footerBox");if(e.length==1&&a.trim(d)!=""){a.getJSON(d,function(f){e.html(unescape(f.html))})}};b.loginOut=function(){var c="/kcms/Logout.aspx?url="+encodeURIComponent(window.location.href);a.post(c,null,null);KLogin.getHeader()};b.loginIn=function(c){var d=window.location.href;if(d.indexOf("uid=")>0){d=SetQueryStringByName(d,"uid",c)}else{if(d.indexOf("?")>0){d=d+"&uid="+c}else{d=d+"?uid="+c}}var e=encodeURIComponent(d);window.location=d};b.loginSuccess=function(c){KLogin.getHeader(c);KLogin.loginIn(c)};window.KLogin=b})(jQuery);function setPlaceholder(b){var a=$(b).parent();if(a.attr("class")!="hidePlaceholder"&&a.attr("class")!="showPlaceholder"){return}if($(b).val()!=""){a.attr("class","hidePlaceholder")}else{a.attr("class","showPlaceholder")}}function LoadScript(a,c){var b=document.createElement("script");b.type="text/javascript";b.src=a;document.getElementsByTagName("head")[0].appendChild(b);if(b.readyState){b.onreadystatechange=function(){if(b.readyState=="loaded"||b.readyState=="complete"){b.onreadystatechange=null;if(c){c()}}}}else{b.onload=function(){if(c){c()}}}}function getCurrentDate(){var f=new Date();var a="-";var c=f.getFullYear();var e=f.getMonth()+1;var b=f.getDate();if(e>=1&&e<=9){e="0"+e}if(b>=0&&b<=9){b="0"+b}var d=c+a+e+a+b;document.write(d)}function checkBoxFn(a){$(a).on("click",".check-all",function(b){b.preventDefault;$tablist=$(this).parents(a);$inputlist=$tablist.find("td input[type='checkbox']");if($(this).prop("checked")){$inputlist.prop("checked",true);len=$inputlist.length;$(this).siblings("label").find("em").html(len)}else{$inputlist.prop("checked",false);$(this).siblings("label").find("em").html(0)}});$(a).siblings(".toolbar").on("click",".check-invert",function(b){b.preventDefault;$tablist=$(this).parents(".toolbar").siblings(a);$inputlist=$tablist.find("td input[type='checkbox']");checkAllBtn=$tablist.find(".check-all");$inputlist.each(function(){if($(this).prop("checked")){$(this).prop("checked",false)}else{$(this).prop("checked",true)}});count=$tablist.find("td input[type='checkbox']:checked").length;len=$inputlist.length;if(count==len){checkAllBtn.prop("checked",true)}if(count==0){checkAllBtn.prop("checked",false)}});$(a).find("td input[type='checkbox']").on("click",function(b){b.preventDefault;$tablist=$(this).parents(a);$inputlist=$tablist.find("td input[type='checkbox']");checkAllBtn=$tablist.find(".check-all");len=$inputlist.length;if($(this).prop("checked")){count=$tablist.find("td input[type='checkbox']:checked").length;if(count==len){checkAllBtn.prop("checked",true)}}else{checkAllBtn.prop("checked",false)}})}function setQrcode(){dllinkBox=$(".dllink-down");if(dllinkBox.hasClass("no-qrcode")){$(".btn-phone").hide();return}var b=$(".dllink").eq(0).find("a.icon");var a=b.length;w=a*b.eq(1).outerWidth(true);if(w>dllinkBox.width()){dllinkBox.width(w)}}function getCookie(a){var c;c="";var b=a+"=";if(document.cookie.length>0){offset=document.cookie.indexOf(b);if(offset!=-1){offset+=b.length;end=document.cookie.indexOf(";",offset);if(end==-1){end=document.cookie.length}c=document.cookie.substring(offset,end);c=unescape(c);return c}}return c}function modifyEcpHeader(a){$("#Ecp_header_Help").before("<a  class='ecp_tn-tab' href='http://kns.cnki.net/kns/subPage/map.aspx'><i>网站地图</i></a>");$("#Ecp_header_ChargeCenter").before(mycnkihtml());if(isnonacad()){a=false}if(a){$(".ecp_top-nav").append(logohtml())}}function mycnkihtml(){var b="uid="+getCookie("LID");var a="<span class='mycnki topItem' id='spanmycnki'>";a+="<a id='link_mycnki' href='javascript:void(0);' onclick='setmycnkiclass()'>我的记录<i class='ecp_tn-arrow'></i></a>";a+="<div id='pop_mycnki' class='topItemPop mycnkipop' style='display:none;'>";a+="<a class='close' href='javascript:void(0)' onclick='$(this).parent().hide()'>x</a>";a+="<div class='klogin_fr'>";a+="<ul class='mlist'>";a+="<li><a href='http://kns.cnki.net/KMycnki/Mycnki/index?"+b+"' target='_blank'>进入 <b>我的记录</b> &gt;&gt;</a></li>";a+="<li><a href='http://kns.cnki.net/KMycnki/Mycnki/index?"+b+"&amp;turnId=keyWord' target='_parent'>我的检索词</a></li>";a+="<li><a href='http://kns.cnki.net/KMycnki/Mycnki/index?"+b+"&amp;turnId=recArticle' target='_parent'>我的推荐</a></li>";a+="<li><a href='http://kns.cnki.net/KMycnki/Mycnki/index?"+b+"&amp;turnId=downLoad' target='_parent'>我的下载</a></li>";a+="<li><a href='http://kns.cnki.net/KMycnki/Mycnki/index?"+b+"&amp;turnId=view' target='_parent'>我的浏览</a></li>";a+="<li><a href='http://kns.cnki.net/KMycnki/Mycnki/index?"+b+"&amp;turnId=read' target='_parent'>我的阅读</a></li>";a+="<li><a href='http://kns.cnki.net/KMycnki/Mycnki/index?"+b+"&amp;turnId=share' target='_parent'>我的分享</a></li>";a+="<li><a href='http://kns.cnki.net/KMycnki/Mycnki/index?"+b+"&amp;turnId=export' target='_parent'>我的导出</a></li>";a+="<li><a href='http://kns.cnki.net/KMycnki/Mycnki/index?"+b+"&amp;turnId=analysis' target='_parent'>我的分析</a></li>";a+=" <li><a href='http://kns.cnki.net/knsdelivery/mycnki.aspx?"+b+"' target='_parent'>我的关注</a></li>";a+="</ul></div>";a+="<div class='klogin_fl'>";a+="<ul class='mlist'>";a+="<li class='prompt'><span>您好，登录可以查看更多信息</span></li>";a+="</ul></div></div></span>";return a}function logohtml(){var a="<div class='Logo'>";a+="<a href='http://www.cnki.net'>";a+="<img src='http://kns.cnki.net/kns/images/gb/logo.gif' alt='中国知网'>";a+="<img class='logohome' src='http://kns.cnki.net/kns/images/gb/home.gif'>";a+="</a></div>";return a}function setmycnkiclass(){$("#spanmycnki").toggleClass("topItemCur");$("#pop_mycnki").toggle()}function LoginSucess(a){if(!a||!a.Uid||a.Uid=="undefined"){return}window.location.href=SetQueryStringByName(window.location.href,"uid",a.Uid)}function Ecp_LogoutOptr(b){var a="/kcms/Logout.aspx?url="+encodeURIComponent(window.location.href);$.post(a,null,null)}function isnonacad(){var b=",CJFT,CJFU,CJFV,CJFX,CJFY";var a=GetQueryStringByName(location.href,"dbcode");var c=GetQueryStringByName(location.href,"sfield");if(b.indexOf(a)>0&&(c==null||c=="")){return true}else{return false}};