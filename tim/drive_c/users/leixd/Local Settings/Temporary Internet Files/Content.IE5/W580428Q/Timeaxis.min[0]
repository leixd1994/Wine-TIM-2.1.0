var BaseUrl;var LinkTarget;var ReferNumArray_CurYear;var Level1NumArrayCurrent;var Level2NumArrayCurrent;var TimeAxis_DefaultStep=2;var TimeAxis_TimeInterval=10;var TimeAxis_IncreaseStep=1;var bExcludeZeroCount=false;var ContentDivIDAttribute="ContentDivID";var ContentDivIDPostfix="_ContentDiv";var TimeAxis_Step=TimeAxis_DefaultStep;var ArrowLeftEnableClass="ArrowLeftEnable";var ArrowLeftDisableClass="ArrowLeftDisable";var ArrowRightEnableClass="ArrowRightEnable";var ArrowRightDisableClass="ArrowRightDisable";var ImgArrowLeftIdPrefix="ArrowLeft_";var ImgArrowRightIdPrefix="ArrowRight_";var ReferTypeDivPrefix="NodeValueDiv";function TimeAxisCell(Year,level1Value,level2Value){this.YearInterval=1;this.CellClass="cell";this.NodeDivClass="number";this.YearDivClass="bottomYear";this.ScaleDivClass=this.__ScaleDivClassShort;this.Year=Year&&new String(Year).toString()||"-1";this.HasDefinedCurYear=typeof ReferNumArray_CurYear!="undefined";this.CurYear=this.HasDefinedCurYear?eval("ReferNumArray_CurYear"):0;this.IsCurrentYear=this.Year==this.CurYear;level1Value=level1Value?new Number(level1Value):0;level2Value=level2Value?new Number(level2Value):0;level1Value=!isNaN(level1Value)?level1Value:0;level2Value=!isNaN(level2Value)?level2Value:0;this.Level1Value=level1Value.toString();this.Level2Value=level2Value.toString();if(!this.IsCurrentYear){this.NodeValue=(level1Value+level2Value).toString()}else{this.NodeValue=(Number(CurYearReferType16Level2)+Number(CurYearReferType1Level1)+Number(CurYearReferType2Level2)+Number(CurYearReferType4Level1)).toString()}this.CheckReferType=function(){if(this.Year.indexOf("-")!=-1){var arrYears=this.Year.split("-"),bSmall=false,bBig=false,bEqual=false;for(var i=0;i<arrYears.length;i++){bSmall=!bSmall?arrYears[i]<this.CurYear:true;bBig=!bBig?arrYears[i]>this.CurYear:true;bEqual=!bEqual?arrYears[i]==this.CurYear:true}this.ReferType=bSmall&&bBig||bEqual?3:bBig?2:bSmall?1:0}};if(!TimeAxisCell.StaticMember){TimeAxisCell.StaticMember=function(){};TimeAxisCell.CellArray=new Array();TimeAxisCell.CurrentCellID=0;TimeAxisCell.GetCell=function(cellID){return TimeAxisCell.CellArray[cellID]};TimeAxisCell.CacheCell=function(cell){TimeAxisCell.CellArray[cell.ID]=cell};TimeAxisCell.GetEventSrcElement=function(){return TimeAxisCell.IsIE?window.event.srcElement:arguments.callee.caller.caller.arguments[0].target};TimeAxisCell.AppendElement=function(parent,son){if(parent&&son){parent.appendChild?parent.appendChild(son):parent.applyElement(son);if(parent.clientWidth>0){son.style.width=son.clientWidth+"px"}}};TimeAxisCell.GetPosition=function(el,dir){var ePos=0;while(el!=null){ePos+=el["offset"+dir];el=el.offsetParent}return ePos};TimeAxisCell.SetUrlValue=function(urlString,key,value){var url=arguments[(len=arguments.length)-3]||window.location.href,sKey=arguments[len-2]||null,sValue=arguments[len-1]||null,len,r;return url?key?(r=url.match(new RegExp(sKey+"s*?=[^&s]*","ig")))?url.replace(r,sKey+"="+(encodeURI?encodeURI(sValue):escape(sValue))):url+"&"+sKey+"="+(encodeURI?encodeURI(sValue):escape(sValue)):url:""};TimeAxisCell.NewGuid=function(){var guid="";for(var i=1;i<=32;i++){guid+=Math.floor(Math.random()*16).toString(16)+(i==8||i==12||i==16||i==20?"-":"")}return guid};TimeAxisCell.IsNumber=function(str){for(var c,i=0;i<str.length;i++){if((c=str.substr(i,1))<"0"||c>"9"){return false}}return true};TimeAxisCell.IsIE=navigator.userAgent.toLowerCase().indexOf("msie")!=-1&&document.all}this.Cell=null;this.ID=TimeAxisCell.NewGuid();TimeAxisCell.CacheCell(this);this.ReferType=TimeAxisCell.IsNumber(this.Year)?(this.Year<this.CurYear)?1:(this.Year>this.CurYear)?2:3:0;this.CheckReferType();var CellDiv=document.createElement("div");CellDiv.className=this.CellClass;this.Cell=CellDiv;var ScaleDiv=document.createElement("div");this.ScaleDivClass="Scale";ScaleDiv.className=this.ScaleDivClass;var YearDiv=document.createElement("div");YearDiv.className=this.YearDivClass;if(!TimeAxisCell.IsNumber(this.Year)||this.Year%this.YearInterval==0||(this.HasDefinedCurYear&&this.Year==this.CurYear)){YearDiv.innerHTML=this.Year}var NodeDiv=document.createElement("div");NodeDiv.className=this.NodeDivClass;if(this.NodeValue.length>0){this.NodeValue=this.NodeValue.replace(" ","&nbsp;");if(this.NodeValue!="0"){TimeAxisCell.AppendElement(YearDiv,new AddValueLink(this.ID,YearDiv));TimeAxisCell.AppendElement(NodeDiv,new NodeValueLink(this))}else{NodeDiv.innerHTML=this.NodeValue}}else{NodeDiv.innerHTML="&nbsp;"}TimeAxisCell.AppendElement(CellDiv,NodeDiv);TimeAxisCell.AppendElement(CellDiv,ScaleDiv);TimeAxisCell.AppendElement(CellDiv,YearDiv)}TimeAxisCell.RenderTimeAxis=function(e,j,f){var g=document.getElementById(f);var h={};if(g&&(e||j)){var k=f+ContentDivIDPostfix;var b=document.createElement("div");b.id=k;b.className="ContentDiv";for(var a=0;a<arguments.length;a++){if(typeof arguments[a]=="string"){break}h=MergeArray(h,arguments[a])}h=SortArrayObject(h);var m=0;for(var l in h){if(l){var d=new TimeAxisCell(l,e[l],j[l]);if(window.bExcludeZeroCount&&(d.NodeValue.length==0||d.NodeValue=="0")){continue}m+=48;TimeAxisCell.AppendElement(b,d.Cell)}}TimeAxisCell.AppendElement(g,b);b.style.width="";b.style.left="-10000px";b.style.width=m+"px";b.style.left="0px";g.style.height="55px";if(b.width<=g.clientWidth){var c=document.getElementById("ArrowRight_"+g.id);if(c){c.className="ArrowRightDisable"}}}};function NodeValueLink(c){if(TimeAxisCell.IsNumber(c.Year)&&c.Year>0){var b=document.createElement("A");b.className="number";b.setAttribute("CellID",c.ID);if(b.addEventListener){b.addEventListener("mouseover",ShowNodeValueDiv,true);b.addEventListener("mouseout",HideNodeValueDiv,true)}else{if(b.attachEvent){b.attachEvent("onmouseover",ShowNodeValueDiv);b.attachEvent("onmouseout",HideNodeValueDiv)}else{b.onmouseover=ShowNodeValueDiv;b.onmouseout=HideNodeValueDiv}}b.innerHTML=c.NodeValue;return b}else{var a=document.createElement("span");a.innerHTML=c.NodeValue;return a}}function AddValueLink(b,c){var a=document.createElement("A");a.setAttribute("CellID",b);if(a.addEventListener){a.addEventListener("mouseover",ShowNodeValueDiv,true);a.addEventListener("mouseout",HideNodeValueDiv,true)}else{if(a.attachEvent){a.attachEvent("onmouseover",ShowNodeValueDiv);a.attachEvent("onmouseout",HideNodeValueDiv)}else{a.onmouseover=ShowNodeValueDiv;a.onmouseout=HideNodeValueDiv}}a.innerHTML=c.innerHTML;c.innerHTML="";return a}function TimeAxisMoveLeft(d){var b=document.getElementById(d);var a=(b)?b.clientWidth:0;var e=document.getElementById(d+ContentDivIDPostfix);if(!e){return}var c=document.getElementById(ImgArrowLeftIdPrefix+d);var f=document.getElementById(ImgArrowRightIdPrefix+d);if(f&&f.className==ArrowRightDisableClass){return}if(c&&c.className==ArrowLeftDisableClass){c.className=ArrowLeftEnableClass}if(e&&e.offsetLeft*-1<e.clientWidth-a){e.style.left=e.offsetLeft-TimeAxis_Step+"px";window.timeout_Move=window.setTimeout("TimeAxisMoveLeft('"+d+"')",TimeAxis_TimeInterval)}else{if(f){f.className=ArrowRightDisableClass}}}function TimeAxisMoveRight(b){var c=document.getElementById(b+ContentDivIDPostfix);if(!c){return}var a=document.getElementById(ImgArrowLeftIdPrefix+b);var d=document.getElementById(ImgArrowRightIdPrefix+b);if(a&&a.className==ArrowLeftDisableClass){return}if(d&&d.className==ArrowRightDisableClass){d.className=ArrowRightEnableClass}if(c&&c.offsetLeft<0){c.style.left=c.offsetLeft+TimeAxis_Step+"px";window.timeout_Move=window.setTimeout("TimeAxisMoveRight('"+b+"')",TimeAxis_TimeInterval)}else{if(a){a.className=ArrowLeftDisableClass}}}function TimeAxisRestore(a){var b=document.getElementById(a+ContentDivIDPostfix);if(b){b.style.left="0px"}}function TimeAxisMoveFaster(){if(TimeAxis_Step<5*TimeAxis_DefaultStep){TimeAxis_Step+=TimeAxis_IncreaseStep}}function TimeAxisStop(){window.clearTimeout(window.timeout_Move);TimeAxis_Step=TimeAxis_DefaultStep}function ShowNodeValueDiv(n){var d=TimeAxisCell.IsIE?window.event:arguments[0] instanceof window.Event?arguments[0]:(o=arguments.callee.caller)?o.arguments[0]:this,o;var e=window.event?d.srcElement:d.target;var c=n&&!(TimeAxisCell.IsIE?n.type&&typeof n.cancelBubble!="undefined":n instanceof window.Event)?TimeAxisCell.GetCell(n):e?TimeAxisCell.GetCell(e.getAttribute("CellID")):null;if(!c){return}TimeAxisCell.CurrentCellID=c.ID;var b=document.getElementById(ReferTypeDivPrefix+c.ReferType);var p=true;if(b&&p){var l=b.getElementsByTagName("span");for(var g=0;g<l.length;g++){if(l[g].id.length==0){continue}var s=0;if(c.IsCurrentYear){var m=l[g].id.replace(b.id,"");s=window["CurYear"+m]}else{var r=l[g].id.substring(l[g].id.length-1);s=c["Level"+r+"Value"]}if(s){l[g].innerHTML="("+s+")"}}var f=b.getElementsByTagName("A");for(var g=0;g<f.length;g++){var k=f[g].id.replace(b.id,"").replace("Link","");var q=k.replace("ReferType","");if(q=="4"){q="3"}else{if(q=="16"){q="4"}}var a="";for(var h=0;h<l.length;h++){if(l[h].id.indexOf(k)!=-1){if(l[h].id.indexOf(k+"6")!=-1){continue}a=l[h].innerText||l[h].textContent;a=a.replace("(","").replace(")","").replace(" ","")}}if(Number(a)>0){f[g].target=LinkTarget;f[g].href=TimeAxisCell.SetUrlValue(BaseUrl,"reftype",q);f[g].href=TimeAxisCell.SetUrlValue(f[g].href,"year",c.Year);f[g].href=TimeAxisCell.SetUrlValue(f[g].href,"totalCount",a);f[g].title="查看本文在"+c.Year+"年的"+f[g].innerHTML}else{f[g].href="javascript:void(0);";f[g].title=""}}b.style.display="block";b.style.left=b.style.pixelLeft=d.clientX-$(".wxMod").offset().left+5+"px"}}function Null(){}function HideNodeValueDiv(a){var c=a&&!(TimeAxisCell.IsIE?a.type&&typeof a.cancelBubble!="undefined":a instanceof window.Event)?TimeAxisCell.GetCell(a):TimeAxisCell.GetCell(TimeAxisCell.CurrentCellID);if(!c){return}var b=document.getElementById(ReferTypeDivPrefix+c.ReferType);if(c&&b){window.timeout_NodeValueDiv=setTimeout("document.getElementById('"+b.id+"').style.display = 'none';",100)}}function MergeArray(e,b){if(b&&e){for(var c in b){if(!c){continue}if(e[c]){var d=new Number(e[c]);var a=new Number(b[c]);if(!isNaN(d)&&!isNaN(a)){e[c]=(d+a).toString()}}else{e[c]=b[c]}}}return e}function SortArrayObject(e){var a=new Array();for(var c in e){if(c&&typeof c=="string"){a.push(c)}}a.sort();var b={};for(var d=0;d<a.length;d++){b[a[d]]=e[a[d]]}return b}var Level1NumArrayLeft=new Object();var Level1NumArrayRight=new Object();var Level2NumArrayLeft=new Object();var Level2NumArrayRight=new Object();var CurYearReferType1Level1="0";var CurYearReferType2Level2="0";var CurYearReferType4Level1="0";var CurYearReferType16Level2="0";function AddToTimeArray(c,a,b){switch(b){case"REFERENCE":Level1NumArrayLeft[c]=a;break;case"SUB_REFERENCE":Level2NumArrayLeft[c]=a;break;case"CITING":Level1NumArrayRight[c]=a;break;case"SUB_CITING":Level2NumArrayRight[c]=a;break}}function AddCurTime(a,b){switch(b){case"REFERENCE":CurYearReferType1Level1=Number(a);break;case"SUB_REFERENCE":CurYearReferType2Level2=Number(a);break;case"CITING":CurYearReferType4Level1=Number(a);break;case"SUB_CITING":CurYearReferType16Level2=Number(a);break}}function RenderTimeAxis(a,b,c){ReferNumArray_CurYear=a;BaseUrl=b;LinkTarget=c;Level1NumArrayCurrent=new Object();Level2NumArrayCurrent=new Object();Level1NumArrayCurrent[a]=0;Level2NumArrayCurrent[a]=0;try{TimeAxisCell.RenderTimeAxis(Level1NumArrayCurrent,Level2NumArrayCurrent,"AxisFrameDivCurrent");TimeAxisCell.RenderTimeAxis(Level1NumArrayLeft,Level2NumArrayLeft,"AxisFrameDivLeft");TimeAxisCell.RenderTimeAxis(Level1NumArrayRight,Level2NumArrayRight,"AxisFrameDivRight")}catch(d){}};